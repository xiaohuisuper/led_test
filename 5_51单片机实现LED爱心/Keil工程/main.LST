C51 COMPILER V9.56.0.0   MAIN                                                              10/05/2021 20:32:09 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /******************************************************************************
   2           * 跑马灯
   3           * P0.0 - P0.7 各接一个LED
   4           * P2.0 - P2.7  LED
   5           * P3.0 - P3.7  LED
   6           ******************************************************************************/
   7          
   8          #include "reg52.h"                       //此文件中定义了单片机的一些特殊功能寄存器
   9          #include<intrins.h>             //因为要用到左右移函数，所以加入这个头文件
  10          
  11          typedef unsigned int u32;         //对数据类型进行声明定义
  12          typedef unsigned char u8;
  13          
  14          #define led1 P0    //将P0口定义为led1 后面就可以使用led1代替P0口
  15          #define led2 P2
  16          #define led3 P3
  17          
  18          /*******************************************************************************
  19          * 函 数 名               : delay
  20          * 函数功能               : 延时函数，i=1时，大约延时10us
  21          *******************************************************************************/
  22          void delay(u32 i)
  23          {
  24   1              while(i--);     
  25   1      }
  26          
  27          /*******************************************************************************
  28          * 函 数 名               : main
  29          * 函数功能               : 主函数
  30          * 输    入               : 无
  31          * 输    出       : 无
  32          *******************************************************************************/
  33          void main()
  34          {
  35   1              u8 i = 0;
  36   1              u8 tmp_H = 0;
  37   1              u8 tmp_L = 0;
  38   1              
  39   1              led1 = 0x00;  //LED低电平点亮
  40   1              led2 = 0x00;
  41   1              led3 = 0x00;
  42   1              delay(50000); //大约延时450ms   
  43   1              led1 = ~0x00;  //LED低电平点亮，所以要取反
  44   1              led2 = ~0x00;
  45   1              led3 = ~0x00;
  46   1      
  47   1              
  48   1              while(1)
  49   1              {       
  50   2                      /* 8个灯循环点亮和熄灭 */
  51   2                      for(i = 0; i < 8; i++) 
  52   2                      {
  53   3                              led1 = ~(0x01 << i);     //将1左移i位，然后将结果赋值到P0口，即切换要点亮的LED
  54   3                              delay(10000);        //粗略的延时，自定义时长，约100ms
  55   3                      }
C51 COMPILER V9.56.0.0   MAIN                                                              10/05/2021 20:32:09 PAGE 2   

  56   2                      led1 = 0xff;
  57   2                      /* 8个灯循环点亮和熄灭 */
  58   2                      for(i = 0; i < 8; i++) 
  59   2                      {
  60   3                              led2 = ~(0x01 << i);     //将1左移i位，然后将结果赋值到P2口，即切换要点亮的LED
  61   3                              delay(10000);        //粗略的延时，自定义时长，
  62   3                      }
  63   2                      led2 = 0xff;
  64   2                      /* 8个灯循环点亮和熄灭 */
  65   2                      for(i = 0; i < 8; i++) 
  66   2                      {
  67   3                              led3 = ~(0x01 << i);     //将1左移i位，然后将结果赋值到P3口，即切换要点亮的LED
  68   3                              delay(10000);        //粗略的延时，自定义时长，
  69   3                      }
  70   2                      led3 = 0xff;
  71   2                      
  72   2                      /* 24个灯循环电量和熄灭（亮8个） */
  73   2                      for(i = 0; i < 24 + 8; i++)
  74   2                      {
  75   3                              if(i < 8)
  76   3                              {
  77   4                                      /* 将0左移i位，然后与P0按位与，即点亮下一个LED，保持前面点亮的LED状态不变 */
  78   4                                      led1 = led1 & ~(0x01 << i);
  79   4                                      delay(10000);
  80   4                              }
  81   3                              if(i >= 8 && i < 16)
  82   3                              {
  83   4                                      /* 将1左移i位，然后和P0按位或，即点亮下一个LED，保持前面点亮的LED状态不变 */
  84   4                                      led1 = led1 | 0x01 << (i - 8);  
  85   4                                      /* 将0左移i位，然后与P2按位与，即点亮下一个LED，保持前面点亮的LED状态不变 */
  86   4                                      led2 = led2 & ~(0x01 << (i - 8)); 
  87   4                                      delay(10000);
  88   4                              }
  89   3                              if(i >= 16 && i < 24)
  90   3                              {
  91   4                                      /* 将1左移i位，然后和P2按位或，即点亮下一个LED，保持前面点亮的LED状态不变 */
  92   4                                      led2 = led2 | 0x01 << (i - 16);         
  93   4                                      /* 将0左移i位，然后与P3按位与，即点亮下一个LED，保持前面点亮的LED状态不变 */
  94   4                                      led3 = led3 & ~(0x01 << (i - 16)); 
  95   4                                      delay(10000);
  96   4                              }
  97   3                              if(i >= 24)
  98   3                              {
  99   4                                      /* 将1左移i位，然后和P3按位或，即点亮下一个LED，保持前面点亮的LED状态不变 */
 100   4                                      led3 = led3 | 0x01 << (i - 24);         
 101   4                                      delay(10000);
 102   4                              }
 103   3                      }
 104   2                      
 105   2                      
 106   2                      /* 兵分两路 */
 107   2                      for(i = 0; i < 12; i++)
 108   2                      {
 109   3                              if(i < 8)
 110   3                              {
 111   4                                      led1 = ~(0x01 << i);     //将1左移i位，然后将结果赋值到P0口，即切换要点亮的LED
 112   4                                      led3 = ~(0x80 >> i);     //将0x80右移i位
 113   4                                      delay(10000);        //粗略的延时，自定义时长，
 114   4                              }
 115   3                              if(i >= 8)
 116   3                              {
 117   4                                      led1 = 0xff;  //灭
C51 COMPILER V9.56.0.0   MAIN                                                              10/05/2021 20:32:09 PAGE 3   

 118   4                                      led3 = 0xff;
 119   4                                      tmp_L = ~(0x01 << (i - 8)); //将led2的0-3号灯中选一个点亮
 120   4                                      tmp_H = ~(0x80 >> (i - 8)); //7-4号灯中选一个点亮
 121   4                                      led2 = (tmp_L & 0x0f) | (tmp_H & 0xf0);
 122   4                                      delay(10000);        //粗略的延时，自定义时长，
 123   4                              }
 124   3                      }
 125   2                      led2 = 0xff;
 126   2              }               
 127   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    348    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
